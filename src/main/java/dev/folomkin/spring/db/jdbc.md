# JDBC

## Исследование инфраструктуры JDBC

Интерфейс JDBC предоставляет приложениям на Java стандартный способ доступа к
информации, хранящейся в базе данных. В основу JDBC положен драйвер, характерный
для каждой базы данных, который и обеспечивает доступ к базе данных из кода,
написанного на Java.

После загрузки драйвер регистрируется с помощью класса java.sql.DriverManager.
Этот класс управляет списком драйверов и предоставляет статические методы для
установления соединений с базой данных. В частности, метод getConnection() из
класса Dri verManager возвращает реализуемый драйвером интерфейс
java.sql.Connection, позволяющий выполнять операторы SQL в базе данных.

## Пакеты JDBC в Spring

- **org.springframework.jdbc.core** - Содержит ядро для классов JDBC в Spring.
  Включает базовый класс JDBC, называемый JdbcTemplate и упрощающий
  программирование операций в базе данных через интерфейс JDBC.
  Многочисленные подпакеты обеспечивают поддержку доступа к данным через
  интерфейс JDBC с более конкретными целями (например, в классе JdbcTemplate
  поддерживаются именованные параметры), а также соответствующие классы для
  такой поддержки;
- **org.springframework.jdbc.datasource** - Содержит вспомогательные классы и
  реализации интерфейса DataSource, которые можно использовать для выполнения
  кода JDBC за пределами контейнера JEE. Многочисленные подпакеты обеспечивают
  поддержку встроенных баз данных, инициализацию баз данных и различные
  механизмы поиска информации в источниках данных
- **org.springframework.jdbc.object** - Содержит классы, помогающие
  преобразовывать данные, возвращаемые из базы, в объекты или списки объектов. А
  поскольку это простые объекты Java, то они отключены от базы данных;
- **org.springframework.jdbc.support** - Наиболее важным средством в этом пакете
  является поддержка преобразования исключений типа SQLException. Это дает
  возможность каркасу Spring распознавать коды ошибок, применяемые в базе
  данных, а также преобразовывать их в исключения более высокого уровня
- **org.springframework.jdbc.config** - Содержит классы, поддерживающие
  конфигурацию JDBC в контексте типа ApplicationContext. Например, в этот пакет
  включается класс обработчика для пространства имен jdbc (например, для
  дескрипторов разметки `<jdЬc:embedded-database>`)

## Соединения с базой данных и источники данных

Для управления автоматическим подключением к базе данных можно воспользоваться
каркасом Spring, предоставив компонент Spring Bean, реализующий интерфейс
javax.sql.DataSource. Отличие между интерфейсами DataSource и
Connection заключается в том, что интерфейс DataSource предоставляет реализации
Connection и управляет ими.
Простейшей реализацией интерфейса DataSource служит класс Dri verManager
DataSource (из пакета org.springframework.jdbc.datasource). Судя по имени
данного класса, он просто обращается к классу Dri verManager для получения
соединения. Вследствие того, что в классе Dri verManagerDataSource не
поддерживается пул соединений с базой данных, он непригоден ни для каких других
целей, кроме тестирования. Сконфигурировать класс DriverManagerDataSource совсем
не трудно, как показано ниже. Для этого достаточно указать имя класса драйвера,
URL соединения, имя пользователя и пароль.

## Применение источников данных в классах ОАО

- Интерфейс DAO. Определяет стандартные операции, выполняемые над отдельным
  объектом или несколькими объектами модели.
- Реализация DAO. Это класс, в котором предоставляется конкретная реализация
  интерфейса ОАО. Как правило, в нем применяется соединение через JDBC или
  источник данных для манипулирования отдельным объектом или несколькими
  объектами модели.
- Объекты модели, иначе называемые объектами данных или сущностями. Это
  результат простого преобразования объекта POJO в запись таблицы базы данных.

## Описание класса JdbcTemplate

Этот класс представляет ядро поддержки интерфейса JDBC в Spring. Он способен
выполнять все типы операторов SQL. Проще говоря, операторы могут быть разделены
на определяющие данные и манипулирующие данными. Операторы определения
данных отвечают за создание разнообразных объектов базы данных (таблиц,
представлений, хранимых процедур и т.п.). А операторы манипулирования данными
взаимодействуют с данными и могут быть подразделены на операторы выборки и
операторы обновления. Как правило, оператор выборки возвращает из таблицы базы
данных ряд строк, каждая из которых содержит один и тот же ряд столбцов. А
оператор обновления модифицирует данные в базе, но никаких результатов не
возвращает.  
Класс JdbcTemplate позволяет выдать базе данных оператор SQL любого типа,
а также возвратить результат любого типа. В этом разделе мы рассмотрим ряд
типичных случаев программируемой поддержки интерфейса JDBC в Spring с помощью
класса JdbcTemplate.

### Инициализация объекта типа JdbcTemplate в классе DAO

Для инициализации JdbcTemplate достаточно сконструировать объект класса
JdbcTemplate, передав его конструктору объект источника данных, который
должен быть внедрен каркасом Spring в класс ОАО.

```java
public class JdbcSingerDao implements SingerDao {
    private DataSource dataSource;
    private JdbcTemplate jdbcTemplate;

    public void setDataSource(DataSource dataSource) {
        this.dataSource = dataSource;
        JdbcTemplate jdbcTemplate = new JdbcTemplate();
        jdbcTemplate.setDataSource(dataSource);
    }
}
```

## RowMapper\<T>

....


