# Абстракция

Абстракция - это принцип ООП, согласно которому при проектировании классов и
создании объектов необходимо выделять только главные свойства сущности, и
отбрасывать второстепенные.  
Класс является абстрактным, если хотя бы один из его методов является
абстрактным.  
Если метод помечен словом abstract, каждый класс-наследник должен его
реализовать или быть объявленным как абстрактный. Иначе компилятор выбросит
ошибку.
Каждый класс может наследоваться только от одного абстрактного класса, так что в
плане наследования разницы между абстрактными и обычными классами нет. Неважно,
наследуемся мы от абстрактного класса или от обычного, класс-родитель может быть
только один.

```java
abstract class Car {
    private int maxSpeed;

    public abstract void gas();

    public int getMaxSpeed() {
        return maxSpeed;
    }

    public void setMaxSpeed(int maxSpeed) {
        this.maxSpeed = maxSpeed;
    }
}

class Sedan extends Car {
    @Override
    public void gas() {
        System.out.println("Седан газует!");
    }
}
```

Абстрактные классы объявляются с ключевым словом abstract и содержат объявления
абстрактных методов, которые не реализованы в этих классах, а будут реализованы
в подклассах. Абстрактный класс может и не содержать вовсе абстрактных методов.
Предназначение такого класса — быть вершиной иерархии его различных
реализаций.  
Объекты таких классов нельзя создать с помощью оператора new, но можно создать
объекты подклассов, которые реализуют все эти методы.При этом допустимо
объявлять ссылку на абстрактный класс, но инициализировать ее можно только
объектом производного от него класса. Абстрактные классы могут содержать и
полностью реализованные методы, а также конструкторы и поля данных. С помощью
абстрактного класса объявляется контракт (требования к функциональности) для его
подклассов. Примером может служить уже рассмотренный выше абстрактный класс
Number и его подклассы Byte, Float и другие.  
Класс Number объявляет контракт на реализацию ряда методов по преобразованию
данных к значению конкретного базового типа, например, floatValue(). Можно
предположить, что реализация метода будет различной для каждого из
классов-оболочек. Объект класса Number нельзя создать явно при помощи его
собственного конструктора.

```java
abstract class AbstractCardAction {
    private long actionId;

    public AbstractCardAction() {
    }

    public void check() {
    }

    public abstract void doPayment(double amountPayment);
}

class CreditCardAction extends AbstractCardAction {
    @Override
    public void doPayment(double amountPayment) {
        // code
    }
}

public class Code {
    public static void main(String[] args) {
        AbstractCardAction action;
// action = new AbstractCardAction(); //compile error: cannot create object!
        action = new CreditCardAction();
        action.doPayment(7);
    }
}
```

Ссылка action на абстрактный суперкласс инициализируется объектом подкласса, в
котором реализованы все абстрактные методы суперкласса. С помощью этой ссылки
могут вызываться также и неабстрактные методы абстрактного класса, если они не
переопределены в подклассе:action.check();

## Абстрактные классы и интерфейсы

### Интерфейсы

Интерфейс — это конструкция в языке Java, которая помогает реализовать
абстрактные методы и статические константы.  
Абстрактные классы похожи на обычные классы, с тем отличием, что они могут
включать абстрактные методы, то есть методы без тела. Абстрактные классы не
могут быть созданы.

**Что такое интерфейс**

По своей сути, интерфейс — это контракт, поэтому он зависит от реализации,
которая определяет цель его создания. Интерфейс не может использовать изменяемые
переменные экземпляра, он может использовать только конечные переменные.

**Когда использовать интерфейсы**

Интерфейсы очень полезны для разделения кода и реализации полиморфизма. Многие
классы принадлежат родительскому классу с одними и теми же действиями методов,
но с разным поведением. В таких ситуациях рекомендуется использовать интерфейс.

**Переопределение метода интерфейса**

Интерфейс — это своего рода контракт, который должен быть реализован конкретным
классом. Методы интерфейса неявно абстрактны и требуют конкретной реализации
класса.

```java
class Code {
    public static void main(String[] args) {
        Challenger challenger = new JavaChallenger();
        challenger.doChallenge();
    }
}

interface Challenger {
    void doChallenge();
}

class JavaChallenger implements Challenger {
    @Override
    public void doChallenge() {
        System.out.println("Challenge done!");
    }
}
```

Интерфейс может содержать только постоянные переменные. Переменные являются
неявными final и static. Это означает, что они являются константами, не зависят
от экземпляра и не могут быть изменены.

**Методы по умолчанию**

Метод по умолчанию может иметь реализацию, а абстрактные методы — нет.
Метод нуждается в реализации. Метод по умолчанию не может быть статическим.

```java
public class DefaultMethodExample {
    public static void main(String[] args) {
        Challenger challenger = new JavaChallenger();
        challenger.doChallenge();
    }
}

class JavaChallenger implements Challenger {
}

interface Challenger {
    default void doChallenge() {
        System.out.println("Challenger doing a challenge!");
    }
}
```

### Абстрактные классы

Любой класс, содержащий один или несколько абстрактных методов, тоже
должен быть объявлен абстрактным. Чтобы объявить класс абстрактным,
перед ключевым словом class в начале объявления класса просто используется
ключевое слово abstract. Объектов абстрактного класса не бывает, т.е.
экз емпляр абстрактного класса нельзя создать напрямую с помощью операции
new. Подобного рода объекты был и бы бесполезными, т.к. абстрактный
класс не определен полностью. Кроме того, не допускается объявлять абстрактные
конструкторы или абстрактные статические методы. Любой подкласс
абстрактного класса должен либо реализовать все абстрактные методы
суперкласса, либо сам быть объявлен абстрактным.

**Суть абстрактного класса**

Абстрактные классы могут иметь состояние с переменными экземпляра. Это означает,
что переменная экземпляра может использоваться и изменяться.

```java
public abstract class AbstractClassMutation {

    private String name = "challenger";

    public static void main(String[] args) {
        AbstractClassMutation abstractClassMutation = new AbstractClassImpl();
        abstractClassMutation.name = "mutated challenger";
        System.out.println(abstractClassMutation.name);
    }

}

class AbstractClassImpl extends AbstractClassMutation {
}
```

**Абстрактные методы в абстрактных классах**

Как и интерфейсы, абстрактные классы могут иметь абстрактные методы. Абстрактный
метод — это метод без тела. В отличие от интерфейсов, абстрактные методы в
абстрактных классах должны быть явно объявлены как абстрактные.

```java
public abstract class AbstractMethods {
    abstract void doSomething();
}
```

**Когда использовать абстрактные классы**

Абстрактный класс рекомендуется использовать, когда вам нужно реализовать
изменяемое состояние. Например, Java Collections Framework включает класс
AbstractList, который использует состояние переменных.

В тех случаях, когда вам не нужно поддерживать состояние класса, обычно лучше
использовать интерфейс.

**Различия между абстрактными классами и интерфейсами**

С точки зрения объектно-ориентированного программирования основное различие
между интерфейсом и абстрактным классом заключается в том, что интерфейс не
может иметь состояние, тогда как абстрактный класс может иметь состояние с
переменными экземпляра.

Другое ключевое отличие состоит в том, что классы могут реализовывать более
одного интерфейса, но они могут расширять только один абстрактный класс. Это
решение основано на том факте, что множественное наследование (расширение более
чем одного класса) может привести к взаимоблокировке кода.

Интерфейсы могут быть реализованы классами или расширены интерфейсами, а классы
могут быть только расширены.

Лямбда-выражения могут использоваться только с функциональным интерфейсом,
в то время как абстрактные классы только с одним абстрактным методом не могут
использовать лямбда-выражения.

Интерфейс:

- Может иметь только конечные статические переменные. Интерфейс никогда не может
  изменить свое собственное состояние.
- Класс может реализовывать несколько интерфейсов.
- Может быть реализован с помощью ключевого слова implements. Интерфейс может
  расширять другой интерфейс.
- Для методов можно использовать только статические конечные поля, параметры или
  локальные переменные.
- Только функциональные интерфейсы могут использовать функцию лямбда в Java.
- Не может иметь конструктор.
- Может иметь абстрактные методы.
- Может иметь методы по умолчанию и статические (представлены в Java 8).
- Может иметь частные методы с реализацией (представлено в Java 9).

Абстрактные классы:

- Могут иметь любые экземпляры или статические переменные, изменяемые или
  неизменяемые.
- Класс может расширять только один абстрактный класс.
- Могут иметь экземпляр изменяемых полей, параметров или локальных переменных.
- Абстрактные классы только с одним абстрактным методом не могут использовать
  лямбда-выражения.
- Могут иметь конструктор.
- Могут иметь любые методы.
