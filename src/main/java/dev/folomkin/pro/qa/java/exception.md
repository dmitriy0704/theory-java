# Исключения в Java

Исключения в Java — это механизм обработки ошибок, который позволяет программе
реагировать на непредвиденные ситуации, такие как деление на ноль, отсутствие
файла или некорректный ввод данных. Они помогают разделить нормальный ход
программы от обработки ошибок, делая код чище и надёжнее.

### Основные понятия

1. **Исключение** — это объект, представляющий ошибочную ситуацию. Все
   исключения в Java являются наследниками класса `Throwable`, который имеет два
   основных подкласса:

- **Error** — серьёзные ошибки, которые обычно не обрабатываются (например,
  `OutOfMemoryError`).
- **Exception** — исключения, которые можно и нужно обрабатывать (например,
  `IOException`, `NullPointerException`).

2. **Checked и Unchecked исключения**:

- **Checked** (проверяемые) — исключения, наследуемые от `Exception` (кроме
  `RuntimeException`). Компилятор требует их обработки с помощью `try-catch` или
  указания в сигнатуре метода через `throws`. Пример: `IOException`,
  `SQLException`.
- **Unchecked** (непроверяемые) — исключения, наследуемые от `RuntimeException`.
  Их обработка необязательна. Пример: `NullPointerException`,
  `ArrayIndexOutOfBoundsException`.

3. **Ключевые слова для работы с исключениями**:

- `try` — блок, в котором может произойти исключение.
- `catch` — блок для обработки исключения.
- `finally` — блок, который выполняется всегда, независимо от возникновения
  исключения (например, для закрытия ресурсов).
- `throw` — используется для явного выброса исключения.
- `throws` — указывает в сигнатуре метода, какие проверяемые исключения он может
  выбросить.

### Пример кода

```java
public class ExceptionExample {
    public static void main(String[] args) {
        try {
            int result = divide(10, 0); // Может выбросить исключение
            System.out.println("Результат: " + result);
        } catch (ArithmeticException e) {
            System.out.println("Ошибка: " + e.getMessage());
        } finally {
            System.out.println("Блок finally выполнен");
        }

        // Пример с проверяемым исключением
        try {
            readFile("nonexistent.txt");
        } catch (IOException e) {
            System.out.println("Ошибка чтения файла: " + e.getMessage());
        }
    }

    public static int divide(int a, int b) {
        if (b == 0) {
            throw new ArithmeticException("Деление на ноль!");
        }
        return a / b;
    }

    public static void readFile(String path) throws IOException {
        throw new IOException("Файл не найден!");
    }
}
```

### Как это работает

1. В `try` помещается код, который может вызвать исключение.
2. Если исключение происходит, выполнение `try` прерывается, и управление
   передаётся в соответствующий `catch`.
3. Блок `finally` выполняется всегда, даже если исключение не было выброшено или
   было поймано.
4. Метод `readFile` использует `throws`, чтобы сообщить, что он может выбросить
   `IOException`, и вызывающий код обязан его обработать.

### Пользовательские исключения

Вы можете создавать собственные исключения, наследуя их от `Exception` или
`RuntimeException`:

```java
class MyException extends Exception {
    public MyException(String message) {
        super(message);
    }
}

public class CustomExceptionExample {
    public static void main(String[] args) {
        try {
            throw new MyException("Это моё исключение!");
        } catch (MyException e) {
            System.out.println(e.getMessage());
        }
    }
}
```

### Лучшие практики

1. **Обрабатывайте только те исключения, которые ожидаете**. Не используйте
   общий `catch (Exception e)` без необходимости.
2. **Используйте finally или try-with-resources** для освобождения ресурсов (
   например, закрытия файлов).
   ```java
   try (FileReader fr = new FileReader("file.txt")) {
       // Работа с файлом
   } catch (IOException e) {
       // Обработка ошибки
   } // FileReader автоматически закрывается
   ```
3. **Не подавляйте исключения**. Пустой `catch` может скрыть проблемы.
4. **Логируйте исключения** с помощью фреймворков вроде SLF4J или Log4j для
   отладки.
5. **Бросайте специфичные исключения**, чтобы код был понятнее. Например, вместо
   `Exception` используйте `IllegalArgumentException`.

### Полезные методы

- `getMessage()` — возвращает сообщение об ошибке.
- `printStackTrace()` — выводит стек вызовов для отладки.
- `getCause()` — возвращает причину исключения, если оно было вызвано другим
  исключением.

Если нужно больше примеров или деталей по конкретному аспекту, напишите!

# Отличие checked и unchecked

В Java исключения делятся на **checked** (проверяемые) и **unchecked** (
непроверяемые). Вот их основные отличия:

1. **Наследование**:

- **Checked**: Наследуются от класса `Exception`, но не от `RuntimeException`.
  Примеры: `IOException`, `SQLException`.
- **Unchecked**: Наследуются от `RuntimeException` (который сам является
  подклассом `Exception`). Примеры: `NullPointerException`,
  `ArrayIndexOutOfBoundsException`.

2. **Обязательность обработки**:

- **Checked**: Компилятор Java требует, чтобы эти исключения были либо
  обработаны в блоке `try-catch`, либо объявлены в сигнатуре метода через
  `throws`. Если этого не сделать, код не скомпилируется.
- **Unchecked**: Обработка необязательна. Компилятор не проверяет,
  обрабатываются ли они, так как они обычно связаны с ошибками программирования,
  которые следует исправлять в коде.

3. **Тип ошибок**:

- **Checked**: Обычно связаны с внешними факторами, которые программа не
  контролирует (например, проблемы с файлами, сетью или базой данных). Их можно
  предвидеть и обработать.
- **Unchecked**: Обычно возникают из-за ошибок в логике программы (например,
  обращение к null или выход за границы массива). Их лучше избегать через
  правильное написание кода.

4. **Пример использования**:
   ```java
   // Checked исключение
   public void readFile() throws IOException { // Обязательно указать throws
       throw new IOException("Ошибка чтения файла");
   }

   // Unchecked исключение
   public void divide(int a, int b) {
       if (b == 0) {
           throw new ArithmeticException("Деление на ноль"); // Не требует throws
       }
   }
   ```

5. **Когда использовать**:

- **Checked**: Используйте для ошибок, которые можно восстановить (например,
  повторная попытка чтения файла).
- **Unchecked**: Используйте для ошибок, которые указывают на баги в программе,
  которые нужно исправить (например, некорректные входные данные).

**Кратко**: Checked исключения заставляют программиста обрабатывать
потенциальные проблемы на этапе компиляции, а unchecked указывают на ошибки,
которые лучше предотвратить через правильный код.